---
title: Multi-Factor (MFA)
sidebar_label: Multi-Factor (MFA)
---

Multi-factor authentication (MFA) is a multi-step account authentication which requires to user to enter more than only the password.
It is highly recommended to use MFA or [Passkeys](/passkey) to make your user accounts more secure.

ZITADEL supports two different Methods:
- Time-based one time password (TOTP), which are Authenticator apps like Google/Microsoft Authenticator, Authy, etc
- Universial Second Factor (U2F), which is authentication with your device like Windows Hello, Apple FaceID, Fingerprint, etc.

## OTP Registration

### Flow

![Register TOTP(/img/guides/login-ui/register-otp-flow.png)

### List the Possible Methods

Your user has successfully authenticated, and now you ask him if he wants to setup MFA to have a more secure account.
When he starts the configuration, first you want him to show the possible methods.
You can either list it implicitly or call the settings service from ZITADEL to get what is configured on the login settings.

More detailed information about the API: [Get Login Settings Documentation](/apis/resources/settings_service/settings-service-get-login-settings)

Request Example:

```bash
curl --request GET \
  --url https://$ZITADEL_DOMAIN/v2alpha/settings/login \
  --header 'Accept: application/json' \
  --header 'Authorization: Bearer '"$TOKEN"''
```

Response Example:
The relevant part for the list is the second factor and multi factor list.

```bash
{
	"details": {
		"sequence": "293",
		"changeDate": "2023-03-29T14:16:55.570482Z",
		"resourceOwner": "163840776835432705"
	},
	"settings": {
		"allowUsernamePassword": true,
		"allowRegister": true,
		"allowExternalIdp": true,
		"passkeysType": "PASSKEYS_TYPE_ALLOWED",
		"passwordCheckLifetime": "864000s",
		"externalLoginCheckLifetime": "864000s",
		"mfaInitSkipLifetime": "2592000s",
		"secondFactorCheckLifetime": "64800s",
		"multiFactorCheckLifetime": "43200s",
		"secondFactors": [
			"SECOND_FACTOR_TYPE_OTP",
			"SECOND_FACTOR_TYPE_U2F"
		],
		"multiFactors": [
			"MULTI_FACTOR_TYPE_U2F_WITH_VERIFICATION"
		],
		"resourceOwnerType": "RESOURCE_OWNER_TYPE_ORG"
	}
}
```

### Start TOTP Registration

The user has selected to setup Time-based One-Time-Password (TOTP).
To show the user the QR to register TOTP with his Authenticator App like Google/Microsoft Authenticator or Authy you have to start the registration on the ZITADEL API.


Request Example:

```bash
curl --request GET \
  --url https://$ZITADEL_DOMAIN/v2alpha/settings/login \
  --header 'Accept: application/json' \
  --header 'Authorization: Bearer '"$TOKEN"''
```

Response Example:
The relevant part for the list is the second factor and multi factor list.

```bash
{
	"details": {
		"sequence": "293",
		"changeDate": "2023-03-29T14:16:55.570482Z",
		"resourceOwner": "163840776835432705"
	},
	"settings": {
		"allowUsernamePassword": true,
		"allowRegister": true,
		"allowExternalIdp": true,
		"passkeysType": "PASSKEYS_TYPE_ALLOWED",
		"passwordCheckLifetime": "864000s",
		"externalLoginCheckLifetime": "864000s",
		"mfaInitSkipLifetime": "2592000s",
		"secondFactorCheckLifetime": "64800s",
		"multiFactorCheckLifetime": "43200s",
		"secondFactors": [
			"SECOND_FACTOR_TYPE_OTP",
			"SECOND_FACTOR_TYPE_U2F"
		],
		"multiFactors": [
			"MULTI_FACTOR_TYPE_U2F_WITH_VERIFICATION"
		],
		"resourceOwnerType": "RESOURCE_OWNER_TYPE_ORG"
	}
}
```