FROM alpine:latest as prepare
RUN adduser -D zitadel
COPY .build/go /app
COPY cmd/zitadel/*.yaml /app/
RUN chmod a+x /app/zitadel

FROM scratch as final
COPY --from=prepare /etc/passwd /etc/passwd
COPY --from=prepare /app /app

USER zitadel

HEALTHCHECK NONE

ENTRYPOINT ["/app/zitadel"]