<app-detail-layout [backRouterLink]="[ serviceType === PolicyComponentServiceType.ADMIN ? '/iam/policies' : '/org']"
    [title]="'POLICY.PRIVATELABELING.TITLE' | translate" [description]="'POLICY.PRIVATELABELING.DESCRIPTION' | translate">

    <p class="default" *ngIf="isDefault"> {{'POLICY.DEFAULTLABEL' | translate}}</p>

    <div class="spinner-wr">
        <mat-spinner diameter="30" *ngIf="loading" color="primary"></mat-spinner>
    </div>

    <ng-template appHasRole [appHasRole]="['policy.delete']">
        <button *ngIf="serviceType === PolicyComponentServiceType.MGMT && !isDefault"
            matTooltip="{{'POLICY.RESET' | translate}}" color="warn" (click)="removePolicy()" mat-stroked-button>
            {{'POLICY.RESET' | translate}}
        </button>
    </ng-template>

    <div *ngIf="previewData" class="content">
      <div class="preview-wrapper">
      <cnsl-preview class="prev" label="CURRENT CONFIG" [policy]="data" [logoURL]="logoURL"></cnsl-preview>
      <cnsl-preview class="prev" label="PREVIEW" [policy]="previewData" [logoURL]="logoURL"></cnsl-preview>
    </div>

      <mat-accordion class="settings">
        <mat-expansion-panel class="expansion">
          <mat-expansion-panel-header>
            <mat-panel-title>
              <div class="panel-title"><mat-icon class="icon">branding_watermark</mat-icon>Logo</div>
            </mat-panel-title>
            <mat-panel-description>
              
            </mat-panel-description>
          </mat-expansion-panel-header>

          <p class="description">Your Logo will be used in the Login itself, while the icon is used for smaller UI elements like in the organisation switcher in console</p>
          
          <span class="title">Dark Design</span>
          <div class="logo-setup-wrapper">
            <div class="part">
              <span class="label">Logo</span>
              <div class="dropzone" cnslDropzone  (hovered)="toggleHoverLogo(Theme.DARK, $event)"
              (dropped)="onDropLogo(Theme.DARK, $event)"
              [class.hovering]="isHoveringOverDarkLogo">
                <label class="file-label">
                  <input #selectedFile style="display: none;"  class="file-input" type="file" (change)="onDropLogo(Theme.DARK, $event.target.files)">
                  <input class="btn" mat-raised-button type="button" [value]="'POLICY.PRIVATELABELING.BTN' | translate" (click)="selectedFile.click();" />

                  <i class="icon las la-cloud-upload-alt"></i>
                  <span class="desc">{{isHoveringOverDarkLogo ? 'Release': 'Drop your Logo here'}}</span>
                </label>
            </div>
            </div>

            <div class="part">
              <span class="label">Icon</span>
              <div class="dropzone" cnslDropzone (hovered)="toggleHoverIcon(Theme.DARK, $event)"
              (dropped)="onDropIcon(Theme.DARK, $event)"
              [class.hovering]="isHoveringOverDarkIcon">
              <label class="file-label">
                <input #selectedFile style="display: none;"  class="file-input" type="file" (change)="onDropIcon(Theme.DARK, $event.target.files)">
                <input class="btn" mat-raised-button type="button" [value]="'POLICY.PRIVATELABELING.BTN' | translate" (click)="selectedFile.click();" />

                <i class="icon las la-cloud-upload-alt"></i>
                <span class="desc">{{isHoveringOverDarkIcon ? 'Release': 'Drop your Logo here'}}</span>
              </label>
              </div>
            </div>
          </div>

          <span class="title">Light Design</span>

          <div class="logo-setup-wrapper">
            <div class="part">
              <span class="label">Logo</span>
              <div class="dropzone" cnslDropzone  (hovered)="toggleHoverLogo(Theme.LIGHT, $event)"
              (dropped)="onDropLogo(Theme.LIGHT, $event)"
              [class.hovering]="isHoveringOverLightLogo">
              <label class="file-label">
                <input #selectedFile style="display: none;"  class="file-input" type="file" (change)="onDropLogo(Theme.LIGHT, $event.target.files)">
                <input class="btn" mat-raised-button type="button" [value]="'POLICY.PRIVATELABELING.BTN' | translate" (click)="selectedFile.click();" />

                <i class="icon las la-cloud-upload-alt"></i>
                <span class="desc">{{isHoveringOverLightLogo ? 'Release': 'Drop your Logo here'}}</span>
              </label>
              </div>
            </div>

            <div class="part">
              <span class="label">Icon</span>
              <div class="dropzone" cnslDropzone (hovered)="toggleHoverIcon(Theme.LIGHT,$event)"
              (dropped)="onDropIcon(Theme.LIGHT, $event)"
              [class.hovering]="isHoveringOverLightIcon">
              <label class="file-label">
                <input #selectedFile style="display: none;"  class="file-input" type="file" (change)="onDropIcon(Theme.LIGHT, $event.target.files)">
                <input class="btn" mat-raised-button type="button" [value]="'POLICY.PRIVATELABELING.BTN' | translate" (click)="selectedFile.click();" />

                <i class="icon las la-cloud-upload-alt"></i>
                <span class="desc">{{isHoveringOverLightIcon ? 'Release': 'Drop your Logo here'}}</span>
              </label>
              </div>
            </div>
          </div>
        </mat-expansion-panel>

        <mat-expansion-panel class="expansion" [expanded]="true">
          <mat-expansion-panel-header>
            <mat-panel-title>
              <div class="panel-title"><mat-icon class="icon">palette</mat-icon>Colors</div>
            </mat-panel-title>
          </mat-expansion-panel-header>

          <span class="title">Dark Design</span>

          <div class="colors">
            <div class="color">
              <cnsl-form-field class="formfield">
                <cnsl-label>Primary Color Hexcode</cnsl-label>
                <input cnslInput [(ngModel)]="previewData.primaryColorDark" />
              </cnsl-form-field>
              <div class="color-selector">
                <div *ngFor="let color of colors" class="circle mat-elevation-z3"
                    [ngClass]="{'active': previewData.primaryColorDark == color.color}"
                    (click)="previewData.primaryColorDark= color.color" [ngStyle]="{'background-color': color.color}">
                    <mat-icon *ngIf="previewData.primaryColorDark == color.color">check</mat-icon>
                </div>
              </div>
            </div>

            <div class="color">
              <cnsl-form-field class="formfield">
                <cnsl-label>Warn Color Hexcode</cnsl-label>
                <input cnslInput [(ngModel)]="previewData.warnColorDark" />
              </cnsl-form-field>
              <div class="color-selector">
                <div *ngFor="let color of warncolors" class="circle mat-elevation-z3"
                  [ngClass]="{'active': previewData.warnColorDark == color.color}"
                  (click)="previewData.warnColorDark= color.color" [ngStyle]="{'background-color': color.color}">
                  <mat-icon *ngIf="previewData.warnColorDark == color.color">check</mat-icon>
                </div>
              </div>
            </div>
        </div>

        <span class="title">Light Design</span>

        <div class="colors">
          <div class="color">
            <cnsl-form-field class="formfield">
              <cnsl-label>Primary Color Hexcode</cnsl-label>
              <input cnslInput [(ngModel)]="previewData.primaryColor" />
            </cnsl-form-field>
            <div class="color-selector">
              <div *ngFor="let color of colors" class="circle mat-elevation-z3"
                  [ngClass]="{'active': previewData.primaryColor == color.color}"
                  (click)="previewData.primaryColor= color.color" [ngStyle]="{'background-color': color.color}">
                  <mat-icon *ngIf="previewData.primaryColor == color.color">check</mat-icon>
              </div>
            </div>
          </div>

          <div class="color">
            <cnsl-form-field class="formfield">
              <cnsl-label>Warn Color Hexcode</cnsl-label>
              <input cnslInput [(ngModel)]="previewData.warnColor" />
            </cnsl-form-field>
            <div class="color-selector">
              <div *ngFor="let color of warncolors" class="circle mat-elevation-z3"
                [ngClass]="{'active': previewData.warnColor == color.color}"
                (click)="previewData.warnColor= color.color" [ngStyle]="{'background-color': color.color}">
                <mat-icon *ngIf="previewData.warnColor == color.color">check</mat-icon>
              </div>
            </div>
          </div>
      </div>
        </mat-expansion-panel>

        <mat-expansion-panel class="expansion">
          <mat-expansion-panel-header class="header">
            <mat-panel-title>
              <div class="panel-title"><mat-icon class="icon">text_fields</mat-icon>Font</div>
            </mat-panel-title>
            <!-- <mat-panel-description>
              {{fontCssRule}}
            </mat-panel-description> -->
          </mat-expansion-panel-header>
          <div class="fonts">
            <div class="font-preview" [style.font-family]="fontCssRule">
              <mat-icon>text_fields</mat-icon>
              <span>ABC • abc • 123</span>
              <span>_</span>
              <span>Select your favorite font for the UI</span>
            </div>
            <cnsl-form-field class="formfield">
              <cnsl-label>CSS Rule for font-family</cnsl-label>
              <input cnslInput [(ngModel)]="fontCssRule" />
            </cnsl-form-field>
            <div class="font-selector">
              <button matTooltip="{{f.name}}" *ngFor="let f of fonts" class="font"
                [ngClass]="{'active': fontCssRule == f.css}" [style.font-family]="f.css"
                (click)="fontCssRule = f.css">
                Aa
            </button>
            </div>
        </div>
        </mat-expansion-panel>

        <mat-expansion-panel class="expansion">
          <mat-expansion-panel-header>
            <mat-panel-title>
              <div class="panel-title">
              <mat-icon class="icon">accessibility_new</mat-icon>Advanced Behavior
            </div>
            </mat-panel-title>
            <!-- <mat-panel-description>
              Currently I am {{panelOpenState ? 'open' : 'closed'}}
            </mat-panel-description> -->
          </mat-expansion-panel-header>
          <div class="adv-container" *ngIf="previewData">
          <mat-slide-toggle class="toggle" color="primary" ngDefaultControl
            [(ngModel)]="previewData.hideLoginNameSuffix">
            {{'POLICY.DATA.HIDELOGINNAMESUFFIX' | translate}}
        </mat-slide-toggle>
        <mat-slide-toggle class="toggle" color="primary" ngDefaultControl
            [(ngModel)]="previewData.disableWatermark">
            {{'POLICY.DATA.DISABLEWATERMARK' | translate}}
        </mat-slide-toggle>
      </div>
        </mat-expansion-panel>
      </mat-accordion>
    </div>

    <div class="btn-container">
        <button (click)="savePolicy()" color="primary" type="submit" mat-raised-button>{{ 'ACTIONS.SAVE' | translate
            }}</button>
    </div>

    <cnsl-links *ngIf="nextLinks" [links]="nextLinks"></cnsl-links>
</app-detail-layout>